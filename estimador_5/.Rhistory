knitr::opts_chunk$set(
echo = TRUE,
message = FALSE,
warning = FALSE)
# Usamos la base de datos 'reclamos' generada en la sección 1.1
n_obs <- length(reclamos) # n = 1000
# --- Generación de la Base de Datos "reclamos" ---
# 1. Fijar la semilla (IMPORTANTE: Esto asegura que salgan los mismos números)
set.seed(123)
# 2. Definir los parámetros verdaderos según tu texto
alpha_true <- 2
beta_true <- 3
n_total <- 1000 # Tamaño de la muestra
# 3. Generar la data (Simulación de Pareto)
# Fórmula de la inversa: x = alpha / (1 - u)^(1/beta)
reclamos <- alpha_true / (1 - runif(n_total))^(1/beta_true)```
# --- Generación de la Base de Datos "reclamos" ---
# 1. Fijar la semilla (IMPORTANTE: Esto asegura que salgan los mismos números)
set.seed(123)
# 2. Definir los parámetros verdaderos según tu texto
alpha_true <- 2
beta_true <- 3
n_total <- 1000 # Tamaño de la muestra
# 3. Generar la data (Simulación de Pareto)
# Fórmula de la inversa: x = alpha / (1 - u)^(1/beta)
reclamos <- alpha_true / (1 - runif(n_total))^(1/beta_true)
# Usamos la base de datos 'reclamos' generada en la sección 1.1
n_obs <- length(reclamos) # n = 1000
x_min_obs <- min(reclamos)
# Cálculo del estadístico T
T_obs <- sum(log(reclamos / x_min_obs))
# Cálculo del Estimador 5 (EIVUM)
beta_eivum_val <- (n_obs - 2) / T_obs
print(paste("Valor Verdadero Beta:", beta_true))
print(paste("Estimación EIVUM:", round(beta_eivum_val, 5)))
print(paste("Diferencia (Sesgo muestral):", round(beta_eivum_val - beta_true, 5)))
# =============================================================================
# GRÁFICO: COMPARACIÓN DE EFICIENCIA (EIVUM vs EMV)
# =============================================================================
set.seed(123)
n_sim <- 50  # Usamos n pequeño para notar diferencias visuales
N_rep <- 5000
sim_eivum <- numeric(N_rep)
sim_emv <- numeric(N_rep)
for(i in 1:N_rep){
# Generar Pareto
u <- runif(n_sim)
x <- alpha_true / (1 - u)^(1/beta_true)
T_val <- sum(log(x / min(x)))
sim_eivum[i] <- (n_sim - 2) / T_val
sim_emv[i] <- n_sim / T_val
}
df_eff <- data.frame(
Valor = c(sim_eivum, sim_emv),
Estimador = rep(c("EIVUM (Insesgado)", "EMV (Sesgado)"), each = N_rep)
)
library(ggplot2)
ggplot(df_eff, aes(x = Valor, fill = Estimador)) +
geom_density(alpha = 0.5) +
geom_vline(xintercept = beta_true, linetype = "dashed", size = 1) +
scale_fill_manual(values = c("green3", "tomato")) +
labs(title = "Comparación de Eficiencia: EIVUM vs EMV",
subtitle = "El EIVUM (Verde) está centrado en 3. El EMV (Rojo) está desplazado a la derecha.",
x = "Estimación de Beta", y = "Densidad") +
theme_minimal() +
xlim(1.5, 5)
# =============================================================================
# GRÁFICO: CONSISTENCIA DEL EIVUM (CONVERGENCIA)
# =============================================================================
# Usamos la base grande 'reclamos' (n=1000)
n_seq <- seq(10, 1000, by = 5)
est_trayectoria <- numeric(length(n_seq))
for(i in 1:length(n_seq)){
k <- n_seq[i]
sub_x <- reclamos[1:k]
T_sub <- sum(log(sub_x / min(sub_x)))
est_trayectoria[i] <- (k - 2) / T_sub
}
df_cons <- data.frame(n = n_seq, Estimacion = est_trayectoria)
ggplot(df_cons, aes(x = n, y = Estimacion)) +
geom_line(color = "blue", size = 0.8) +
geom_hline(yintercept = beta_true, color = "red", linetype = "dashed", size = 1) +
labs(title = "Consistencia del Estimador 5 (EIVUM)",
subtitle = "Convergencia al valor verdadero (3) al aumentar la muestra",
x = "Tamaño de muestra (n)", y = "Valor Estimado") +
theme_minimal() +
ylim(2.5, 3.5)
